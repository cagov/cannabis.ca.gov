{% set locale_dir = ["/"] | join %}

{% if locale != "en" %}
  {% set locale_dir = ["/", locale, "/"] | join %}
{% endif %}

<!-- https://designsystem.webstandards.ca.gov/components/site-navigation/readme/ -->
<cagov-site-navigation>
  <div class="container">
    <nav class="expanded-menu" role="navigation" aria-label="{{ 'Site Navigation' | i18n(locale) }}" aria-hidden="false" id="main-menu">
      <div class="expanded-menu-grid">

        <div class="expanded-menu-col js-cagov-navoverlay-expandable">
          <div class="expanded-menu-section">
            <strong class="expanded-menu-section-header">
              <a class="expanded-menu-section-header-link js-event-hm-menu" href="{{ locale_dir }}">{{ 'Home' | i18n(locale) }}</a>
            </strong>
          </div>
        </div>

        {% for menu in headerMenu %}
          <div class="expanded-menu-col js-cagov-navoverlay-expandable">
            <div class="expanded-menu-section">
              <strong class="expanded-menu-section-header">
                {% if menu['child_items'] %}
                  <button class="expanded-menu-section-header-link js-event-hm-menu">
                    <span>
                      {{ menu.title | safe }}
                    </span>
                    <span class="expanded-menu-section-header-arrow">
                      <svg width="11" height="7" class="expanded-menu-section-header-arrow-svg" viewbox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M1.15596 0.204797L5.49336 5.06317L9.8545 0.204797C10.4293 -0.452129 11.4124 0.625368 10.813 1.28143L5.90083 6.82273C5.68519 7.05909 5.32606 7.05909 5.1342 6.82273L0.174341 1.28143C-0.400433 0.6245 0.581838 -0.452151 1.15661 0.204797H1.15596Z" fill="#064E66"/>
                      </svg>
                    </span>
                  </button>
                {% else %}
                  <a class="expanded-menu-section-header-link js-event-hm-menu" href="{{ menu.url }}">
                    {{ menu.title | safe }}
                  </a>
                {% endif %}
              </strong>

              {% if menu['child_items'] | length %}
                <div class="expanded-menu-dropdown">
                  {% for sublink in menu['child_items'] %}
                    <a class="expanded-menu-dropdown-link js-event-hm-menu" href="{{ sublink.url  }}" tabindex="-1">{{ sublink.title | safe }}</a>
                  {% endfor %}
                </div>
              {% endif %}

            </div>
          </div>
        {% endfor %}

      </div>
    </nav>
  </div>
</cagov-site-navigation>
