<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>D3 World Map</title>
    <style>
      path.dm-1 {
        fill: #fcd37f;
      }
      path.dm-2 {
        fill: #ffaa00;
      }
      path.dm-3 {
        fill: #e60000;
      }
      path.dm-4 {
        fill: #730000;
      }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
  </head>
  <body>
    <script type="text/javascript">
      var width = 500;
      var height = 590;

      var svg = d3
        .select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      var identity = d3.geoIdentity().reflectY(true);
      var path = d3.geoPath(identity);

      d3.json("/data/caDroughtMap.topo.json").then((json) => {
        var geojson = topojson.feature(json, json.objects.data);
        identity.fitSize([width, height], geojson);
        geojson.features.forEach((element) => {
          svg
            .append("path")
            .datum(element.geometry)
            .attr("d", path)
            .attr("class", `dm-${element.properties.DM}`);
        });
      });
    </script>
  </body>
</html>
